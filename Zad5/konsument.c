//Kacper Tatrocki 21.04.2022, Krakow#include <stdio.h>#include <unistd.h>#include <stdlib.h>#include <sys/types.h>#include <sys/wait.h>#include <sys/stat.h>#include <fcntl.h>#include <string.h>#include <time.h>#include <stdlib.h>int main (int argc, char *argv[]) {		char buf[1024];	char wiadomosc[1038];	int plik;	int potok;	int odczyt;	const size_t rozmiarKon=10;	// sprawdzenie poprawności argumentów	if(argc!=3) {									//sprawdzanie ilosci wprowadzonych argumentow		printf("Niepoprawna liczba argumentow!\n");		printf("Wywolaj program wpisujac: %s plik_wy potok\n", argv[0]);		exit(EXIT_FAILURE);	}		srand(time(NULL));								//czekanie randomowej ilosci czasu		if((plik=open(argv[1], O_WRONLY | O_CREAT | O_TRUNC, 0644))==-1) {		//otwieranie pliku		printf ("Blad otwarcia pliku %s\n", argv[1]);		perror ("Blad pliku");		exit (EXIT_FAILURE);	}		if((potok=open(argv[2], O_RDONLY, 0644))==-1) {				//otwieranie potoku		printf("Blad otwarcia potoku %s\n", argv[2]);		perror("Blad pliku");		exit(EXIT_FAILURE);	}		while(1) {		sleep((double)(rand()%(int)(2.5*100))/100);				//czekaj losową ilość czasu				odczyt=read(potok, &buf, rozmiarKon);		if(odczyt==-1) {			printf("Blad odczytu z potoku\n");			exit(EXIT_FAILURE);		} else if (odczyt==0) {			break;		} else {			if(write(plik, &buf, odczyt)==-1){				//odczyt z pliku				perror("Blad write do pliku");				exit(EXIT_FAILURE);			}						buf[odczyt]='\0';			sprintf(wiadomosc, "%s%s%s", "Konsumuje - ", buf, "\n");						if(write(STDOUT_FILENO, wiadomosc, strlen(wiadomosc))==-1){				perror("Blad write na ekran");				exit(EXIT_FAILURE);			}		}	}		if(close(plik)==-1) {									//oblugi bledow		perror("Blad zamkniecia pliku wyjscia");		exit(EXIT_FAILURE);	}		if(close(potok)==-1) {		perror("Blad zamkniecia potoku");		exit(EXIT_FAILURE);	}	return 0;}